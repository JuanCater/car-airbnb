<div class="container">

 <%= link_to "Back to all cars", cars_path, class: "btn btn-primary m-4" %>

  <div class="d-flex justify-content-around border border-primary p-2">
    <span class="align-self-center">
        <div class="text-center">
          <% if policy(@car).edit? %>
             <%= link_to "Edit this car", edit_car_path(@car), class: "btn btn-primary" %>
          <% end %>
            <h2><%= @car.brand %></h2>
             <p>Model: <%= @car.model %></p>
            <p>Year: <%= @car.year %></p>
            <p>Price per night: $<%= @car.price %></p>
            <%= button_to "Destroy this car", @car, method: :delete if policy(@car).destroy? %>
        </div>
    </span>
    <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
      <ol class="carousel-indicators">
        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
        <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
        <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
      </ol>
      <div class="carousel-inner">
        <div class="carousel-item active">
          <%=  cl_image_tag @car.photos.first.key, height: 300, width: 400, crop: :fill  %>
        </div>
        <div class="carousel-item">
          <%= cl_image_tag @car.photos.last.key, height: 300, width: 400, crop: :fill %>
        </div>
      </div>
      <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
      </a>
      <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
      </a>
    </div>
  </div>







  <% if @car.user == current_user %>
    <h1 class="text-center">Reservations for this car</h1>
      <%@car.reservations.each do |reservation| %>
        <div class="card">
          <p>Requested by: <%= reservation.user.email %></p>
          <p>Date of Rental: <%= reservation.rented_from%></p>
          <p>Date of return: <%= reservation.rented_until%></p>
          <p>Status: <%= reservation.status %></p>
          <%= link_to "Edit my reservation", edit_car_reservation_path(@car, reservation), class: "btn btn-primary" %>
        </div>
      <%end %>
  <%end %>

  <% @car.reservations.each do |reservation| %>
    <% if reservation.user == current_user %>
        <h1 class="text-center">My Reservations for this car</h1>
        <%@car.reservations.each do |reservation| %>
          <div class="card">
            <p>Owner: <%= reservation.car.user.email %></p>
            <p>Date of Rental: <%= reservation.rented_from%></p>
            <p>Date of Return: <%= reservation.rented_until%></p>
            <p>Status: <%= reservation.status %></p>
            <%= link_to "Edit my reservation", edit_car_reservation_path(@car, reservation), class: "btn btn-primary" %>
          </div>
      <%end %>
    <%end %>
  <%end %>


  <%= link_to "Request to reserve this car", new_car_reservation_path(@car), class: "btn btn-primary" if @car.user != current_user %>



</div>
