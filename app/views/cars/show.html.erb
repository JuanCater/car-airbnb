<%= link_to "Back to all cars", cars_path, class: "btn btn-primary m-4" %>

<div class="container">


  <div class="d-flex justify-content-around border border-primary p-2 w-100">
    <span class="align-self-center">
        <div class="text-center">
          <% if policy(@car).edit? %>
             <%= link_to "Edit this car", edit_car_path(@car), class: "btn btn-primary" %>
          <% end %>
            <h2><%= @car.brand %></h2>
             <p>Model: <%= @car.model %></p>
            <p>Year: <%= @car.year %></p>
            <p>Price per night: $<%= @car.price %></p>
            <p>Contact the owner: <%= @car.user.email %></p>
            <%= button_to "Destroy this car", @car, method: :delete if policy(@car).destroy? %>
        </div>
    </span>


    <div id="carouselExampleIndicators" class="carousel slide w-50" data-bs-ride="carousel">

      <div class="carousel-inner">
      <% @car.photos.each_with_index do |photo, index| %>
        <div class="carousel-item <%= index == 0 ? 'active' : '' %>">
                <%= cl_image_tag photo.key, class: "d-block w-100", crop: :fill %>
              </div>
      <% end %>
       </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
      </div>
    </div>

  </div>

  <% if @car.user == current_user %>
    <h1 class="text-center">Reservations for this car</h1>
      <%@car.reservations.each do |reservation| %>
        <div class="card">
          <p>Requested by: <%= reservation.user.email %></p>
          <p>Date of Rental: <%= reservation.rented_from%></p>
          <p>Date of return: <%= reservation.rented_until%></p>
          <p>Status: <%= reservation.status %></p>
          <%= simple_form_for [@car, reservation] do |f| %>
          <%=f.hidden_field :rented_from %>
          <%= f.hidden_field :rented_until %>
          <%= f.input :status, collection: ["pending", "accepted", "denied"] %>
          <%= f.button :submit, class: "btn btn-primary" %>
          <% end %>
        </div>
      <%end %>
  <%end %>

  <%= link_to "Request to reserve this car", new_car_reservation_path(@car), class: "btn btn-primary" if @car.user != current_user %>


</div>
