<% if policy(@car).edit? %>
  <%= link_to "Edit this car", edit_car_path(@car), class: "btn btn-primary" %> |
<% end %>


<h2><%= @car.brand %></h2>
<p>Model: <%= @car.model %></p>
<p>Year: <%= @car.year %></p>
<p>Price per night: <%= @car.price %></p>
<% @car.photos.each do |photo| %>
  <%= cl_image_tag photo.key, height: 300, width: 400, crop: :fill %>
<% end %>


<%= button_to "Destroy this car", @car, method: :delete if policy(@car).destroy? %>

<% if @car.user == current_user %>
  <h1>Reservations for this car</h1>
    <%@car.reservations.each do |reservation| %>
      <div class="card">
        <p>Requested by: <%= reservation.user.email %></p>
        <p>Date of Rental: <%= reservation.rented_from%></p>
        <p>Date of return: <%= reservation.rented_until%></p>
        <p>Status: <%= reservation.status %></p>
        <%= link_to "Edit my reservation", edit_car_reservation_path(@car, reservation), class: "btn btn-primary" %>
      </div>
    <%end %>
<%end %>

<% @car.reservations.each do |reservation| %>
  <% if reservation.user == current_user %>
      <h1>My Reservations for this car</h1>
      <%@car.reservations.each do |reservation| %>
        <div class="card">
          <p>Owner: <%= reservation.car.user.email %></p>
          <p>Date of Rental: <%= reservation.rented_from%></p>
          <p>Date of Return: <%= reservation.rented_until%></p>
          <p>Status: <%= reservation.status %></p>
          <%= link_to "Edit my reservation", edit_car_reservation_path(@car, reservation), class: "btn btn-primary" %>
        </div>
    <%end %>
  <%end %>
<%end %>


<%= link_to "Request to reserve this car", new_car_reservation_path(@car), class: "btn btn-primary" if @car.user != current_user %>


<%= link_to "Back to all cars", cars_path, class: "btn btn-primary" %>
